#!/usr/bin/env node

'use strict';

const _program = require('commander');
const _path = require('path');
const _join = _path.join;
const _ = require('lodash');
const $template = require('../service/template');
const $root = require('../service/root');
const $MriVersion = require('../service/mri-version-upgrade');
const $Bus = require('../lib/services/bus');
const _which = require('which');
const _shell = require('shelljs');
const _spawn = require('cross-spawn');
const _chalk = require('chalk');

const $log = require('../service/log');
const $util = require('../lib/common/util');
const $run = require('../lib/common/run');

const $upgrade = require('../upgrade/v2.9.0');

const loading = require('loading-cli');



_program
    .usage('test [options]')
    .option('-m, --mri [mri]', 'mri所在路径（no ln)')
    .parse(process.argv);

$run.root(() => {
    $run.package(() => {
        $run.upgrade(() => {
            $run.branch('dev', () => {
                // $upgrade();

                // console.debug(1111111);


            });
        });
    });
});

// console.debug(_program);

// $log.template({currentVersion: '1.0.1', updateVersion: '1.0.2'}, '../template/others/update-version.ejs');

// 批量生成 theme 的文件
// let themes = $root.getThemes(null);
// _.each(themes, (theme) => {
//     $template.create(
//         {
//             theme,
//         },
//         '../template/project/theme/{theme}-preset.ts.ejs',
//         `src/theme/${theme}/${theme}-preset.ts`,
//     );
// });

// 批量删除 branch

// _shell.exec(`git branch -l 'release/demo*'`)

// $Bus.mriUpdate();

// _which('node', (er) => {
//     if(er) {
//         _shell.echo('asas')
//     } else {
//         _shell.echo('mri asas')
//     }
// });
//
// var resolved = _which.sync('node', (er) => {
//     if(er) {
//         _shell.echo('asas 1111')
//     } else {
//         _shell.echo('mri asas 222')
//     }
// });
//
// console.log( __dirname );
//
// _spawn('/Users/Mizi/git/mri-cli/bin/mri', ['interface', '-i'], { stdio: "inherit" });
